import { handler } from "lambda-functions/getUserExercisesHandler.mjs";
import { ERROR } from "trophy-common-utils/TestErrors.mjs";


const testGetUserExercises = async (event) => {
    // Time the test
    console.time("test");

    // Get the response body
    let response = await handler(event);

    // Check the status code
    if (response.statusCode !== 200) {
        console.error(JSON.parse(response.body).stack);
        console.error(JSON.parse(response.body).message);
        throw new Error(`${ERROR.ERROR_LAMBDA_FUNCTION_FAILED_STATUS_CODE} ${response.statusCode}`);
    }
    else {
        // Parse the body to retrieve the exercise value
        const exerciseValue = JSON.parse(response.body).exercises;
        const messageValue = JSON.parse(response.body).message;

        // Pretty print the exercise value OR print out warning message if no exercises found
        const prettyExercisesValue = JSON.stringify(exerciseValue, null, 2);
        const exerciseOutput = exerciseValue.length > 0 ? prettyExercisesValue : messageValue

        console.log(exerciseOutput);

        console.log("Test Passed! with time");
        console.timeEnd("test");
    }
}

const event = {
    pathParameters: {
        userId: "4bf0e7ef-cd19-4b0c-b9a2-e946c58e01d1"
    }
}

const eventNoUserID = {
    pathParameters: {
    }
}

const eventInvalidUserID = {
    pathParameters: {
        userId: "this-id-should-not-work"
    }
}

const eventEmpty = {
}

testGetUserExercises(event);